<?xml version="1.0" encoding="utf-8"?>
<Metadata Name="XSC_MailEaterBase V2 External" TimeZone="FLE Standard Time;120;(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius;FLE Standard Time;FLE Daylight Time;[01:01:0001;12:31:9999;60;[0;03:00:00;3;5;0;];[0;04:00:00;10;5;0;];];" TimeStamp="2021-09-09T14:11:24.0645066Z" ClientSchemaVersion="1.1" PackageType="incremental" Exported="True">
  <Source Host="stg-newsupport.synergy.lt" Role="Admin" RoleName="Admin" Username="HEATAdmin" TenantID="stg-NEWSUPPORT.synergy.lt" TimeZone="FLE Standard Time;120;(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius;FLE Standard Time;FLE Daylight Time;[01:01:0001;12:31:9999;60;[0;03:00:00;3;5;0;];[0;04:00:00;10;5;0;];];" TimeStamp="2021-09-09T14:11:24.0645066Z" SystemVersion="2020.1.0.20200402" SystemTableVersion="671.0" SystemSchemaVersion="1.0" />
  <Target Host="stg-newsupport.synergy.lt" Role="Admin" RoleName="Admin" Username="HEATAdmin" TenantID="stg-NEWSUPPORT.synergy.lt" TimeZone="FLE Standard Time;120;(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius;FLE Standard Time;FLE Daylight Time;[01:01:0001;12:31:9999;60;[0;03:00:00;3;5;0;];[0;04:00:00;10;5;0;];];" TimeStamp="2021-09-09T14:11:24.0645066Z" SystemVersion="2020.1.0.20200402" SystemTableVersion="671.0" SystemSchemaVersion="1.0" />
  <Differences>
    <Updates>
      <BusinessObjects Seq="1509" DbRevision="671">
  <Inserts>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#">
      <Annotations AggregateType="Dictionary" />
      <AuditedFieldsAndRelationships AggregateType="Set" />
      <AuditObjectChanges CLR_Type="System.Boolean">true</AuditObjectChanges>
      <CalculatedRules AggregateType="Dictionary" />
      <ClusteredIdFieldRef nil="true" CLR_Type="System.String" />
      <ClusteredPrimaryKey CLR_Type="System.Boolean">false</ClusteredPrimaryKey>
      <CommonlyUsed CLR_Type="System.Boolean">false</CommonlyUsed>
      <CompositeBase nil="true" CLR_Type="System.String" />
      <CompositeContracts AggregateType="List" />
      <CompositeType nil="true" CLR_Type="System.String" />
      <Description CLR_Type="System.String"></Description>
      <DesignerName CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword</DesignerName>
      <DisplayFieldRef CLR_Type="System.String"></DisplayFieldRef>
      <DisplayName CLR_Type="System.String">Task WorkOrder Status Keyword</DisplayName>
      <EditInFinalState CLR_Type="System.Boolean">false</EditInFinalState>
      <ExternalTable nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExternalTableMetaData" />
      <Fields AggregateType="Dictionary">
        <Field AggregateType="Object" FRS_ID="RecId" DisplayName="Record Identifier">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">FixedText</DataType>
          <Description CLR_Type="System.String">Uniquely identifies the definition record.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">Record Identifier</DisplayName>
          <FieldName CLR_Type="System.String">RecId</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">true</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">32</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">false</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">true</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
        <Field AggregateType="Object" FRS_ID="CreatedBy" DisplayName="Created By">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">UnicodeText</DataType>
          <Description CLR_Type="System.String">The user who created this record.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">Created By</DisplayName>
          <FieldName CLR_Type="System.String">CreatedBy</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">50</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">false</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">false</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
        <Field AggregateType="Object" FRS_ID="CreatedDateTime" DisplayName="Created On">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">DateTime</DataType>
          <Description CLR_Type="System.String">Date time record was created.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">Created On</DisplayName>
          <FieldName CLR_Type="System.String">CreatedDateTime</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">0</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">false</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">false</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
        <Field AggregateType="Object" FRS_ID="LastModBy" DisplayName="Modified By">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">UnicodeText</DataType>
          <Description CLR_Type="System.String">The last user to modify the record.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">Modified By</DisplayName>
          <FieldName CLR_Type="System.String">LastModBy</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">50</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">false</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">false</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
        <Field AggregateType="Object" FRS_ID="LastModDateTime" DisplayName="Modified On">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">DateTime</DataType>
          <Description CLR_Type="System.String">The date and time the record was last modified.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">Modified On</DisplayName>
          <FieldName CLR_Type="System.String">LastModDateTime</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">0</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">false</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">false</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
        <Field AggregateType="Object" FRS_ID="ReadOnly" DisplayName="ReadOnly">
          <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
          <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
          <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
          <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
          <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
          <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
          <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
          <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
          <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
          <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
          <DataType CLR_Type="MetaDataDefinition.DBDataType">Int1</DataType>
          <Description CLR_Type="System.String">Allows object change its state to read only mode.</Description>
          <DesignerName nil="true" CLR_Type="System.String" />
          <DisplayName CLR_Type="System.String">ReadOnly</DisplayName>
          <FieldName CLR_Type="System.String">ReadOnly</FieldName>
          <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
          <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
          <HideFromUI CLR_Type="System.Boolean">true</HideFromUI>
          <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
          <IsFrsOwned CLR_Type="System.Boolean">true</IsFrsOwned>
          <IsInternal CLR_Type="System.Boolean">false</IsInternal>
          <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
          <Length CLR_Type="System.Int32">0</Length>
          <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
          <Nullable CLR_Type="System.Boolean">true</Nullable>
          <Permissions />
          <Scale CLR_Type="System.Int32">0</Scale>
          <SourceFieldName nil="true" CLR_Type="System.String" />
          <SourceTableRef nil="true" CLR_Type="System.String" />
          <Stored CLR_Type="System.Boolean">true</Stored>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">false</Unique>
          <IsContractField CLR_Type="System.Boolean">false</IsContractField>
        </Field>
      </Fields>
      <FieldsEncryptions AggregateType="Dictionary" CLR_Name="FieldsEncryption" />
      <FieldsPublicEncryptions AggregateType="Dictionary" CLR_Name="FieldsPublicEncryption" />
      <FullTextSearchIndex nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.FullTextSearchIndexMetaData" />
      <Indexes AggregateType="Dictionary">
        <Index AggregateType="Object" FRS_ID="PK_XSC_TenantEmailTaskWorkOrderKeyword">
          <Conditions AggregateType="List" />
          <Description nil="true" CLR_Type="System.String" />
          <Fields AggregateType="List">
            <Field AggregateType="Object" FRS_Index="0">
              <FieldRef CLR_Type="System.String">RecId</FieldRef>
              <Order CLR_Type="MetaDataDefinition.Revisions.R1.IndexFieldOrder">Ascending</Order>
              <Included CLR_Type="System.Boolean">false</Included>
              <KeyOrdinal CLR_Type="System.Int32">1</KeyOrdinal>
              <Rank CLR_Type="System.Int32">0</Rank>
            </Field>
          </Fields>
          <IndexName CLR_Type="System.String">PK_XSC_TenantEmailTaskWorkOrderKeyword</IndexName>
          <IsClustered CLR_Type="System.Boolean">false</IsClustered>
          <IsDisabled CLR_Type="System.Boolean">false</IsDisabled>
          <IsPrimaryKey CLR_Type="System.Boolean">true</IsPrimaryKey>
          <Origin CLR_Type="MetaDataDefinition.Revisions.R1.IndexOrigin">AutoCreated</Origin>
          <System CLR_Type="System.Boolean">true</System>
          <Unique CLR_Type="System.Boolean">true</Unique>
        </Index>
      </Indexes>
      <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
      <IsInChangeControl CLR_Type="System.Boolean">false</IsInChangeControl>
      <LinkInFinalState CLR_Type="System.Boolean">false</LinkInFinalState>
      <TenantMetaRevision CLR_Type="System.Int32">0</TenantMetaRevision>
      <ModalForm nil="true" CLR_Type="System.String" />
      <ObjectType CLR_Type="MetaDataDefinition.Revisions.R1.ObjectType">Simple</ObjectType>
      <PrimaryKeyFieldRef CLR_Type="System.String">RecId</PrimaryKeyFieldRef>
      <PureValidationObject CLR_Type="System.Boolean">false</PureValidationObject>
      <PutInRecallState CLR_Type="System.Boolean">false</PutInRecallState>
      <ReadOnly CLR_Type="System.Boolean">false</ReadOnly>
      <Rel2s AggregateType="Dictionary" CLR_Name="Rel2" />
      <Relationships AggregateType="Dictionary" />
      <SearchDefaultFields nil="true" />
      <SearchPreviewFields nil="true" />
      <StateFieldRef CLR_Type="System.String"></StateFieldRef>
      <SubtypeName CLR_Type="System.String"></SubtypeName>
      <System CLR_Type="System.Boolean">false</System>
      <TableName CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword</TableName>
      <TableRef CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword#</TableRef>
      <TypeSelectorFieldRef CLR_Type="System.String"></TypeSelectorFieldRef>
      <ValidatedFields AggregateType="Dictionary" />
      <DefaultSearch nil="true" CLR_Type="System.String" />
      <Definition nil="true" CLR_Type="System.String" />
      <Id CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword#</Id>
      <LastModified CLR_Type="System.DateTime">2021-09-09T08:02:16.21Z</LastModified>
      <ModifiedBy nil="true" CLR_Type="System.String" />
      <Revision CLR_Type="System.String">C85DD35268A97778D1274C398475AEBDB66C0D18</Revision>
      <IsExternalData CLR_Type="System.Boolean">false</IsExternalData>
      <ExternalData nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ReadOnly.ExternalData" />
    </BusinessObject>
  </Inserts>
</BusinessObjects>
      <BusinessObjects Seq="1511" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <Fields AggregateType="Dictionary">
          <Inserts>
            <Field AggregateType="Object" FRS_ID="StatusKeyword" DisplayName="Status Keyword">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">UnicodeText</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">Status Keyword</DisplayName>
              <FieldName CLR_Type="System.String">StatusKeyword</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">255</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">true</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
          </Inserts>
        </Fields>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <BusinessObjects Seq="1512" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <AuditedFieldsAndRelationships AggregateType="Set">
          <Inserts>
            <AuditedFieldsAndRelationship CLR_Type="System.String">TaskWorkOrderStatus</AuditedFieldsAndRelationship>
          </Inserts>
        </AuditedFieldsAndRelationships>
        <Fields AggregateType="Dictionary">
          <Inserts>
            <Field AggregateType="Object" FRS_ID="TaskWorkOrderStatus" DisplayName="Task WorkOrder Status">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">UnicodeText</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">Task WorkOrder Status</DisplayName>
              <FieldName CLR_Type="System.String">TaskWorkOrderStatus</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Simple</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">40</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">true</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
          </Inserts>
        </Fields>
        <Relationships AggregateType="Dictionary">
          <Inserts>
            <Relationship AggregateType="Object" FRS_ID="Audit_XSC_TenantEmailTaskWorkOrderKeyword#.">
              <Binding CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipBinding">Contains</Binding>
              <CompositeTypeFilters nil="true" CLR_Name="CompositeTypeFilter" />
              <Condition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
              <DesignerName CLR_Type="System.String">AuditHistoryRelationship</DesignerName>
              <Direction CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipDirection">Normal</Direction>
              <DisplayName nil="true" CLR_Type="System.String" />
              <ForeignKey AggregateType="Object">
                <PKField CLR_Type="System.String">RecId</PKField>
                <FKField CLR_Type="System.String">(other)AuditHistoryUpdatedRecId</FKField>
                <FKCategoryField nil="true" CLR_Type="System.String" />
              </ForeignKey>
              <FullTextSearchIndex CLR_Type="System.Boolean">false</FullTextSearchIndex>
              <HereCardinality CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipCardinality">One</HereCardinality>
              <HerePreventDelete CLR_Type="System.Boolean">false</HerePreventDelete>
              <HereRequired CLR_Type="System.Boolean">true</HereRequired>
              <Implementation CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipImplementation">Constraint</Implementation>
              <IncludeObjectsFromFields nil="true" />
              <IsASymmetric CLR_Type="System.Boolean">false</IsASymmetric>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsDeprecated CLR_Type="System.Boolean">false</IsDeprecated>
              <LinkTableFieldMapping nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <LinkTableName nil="true" CLR_Type="System.String" />
              <OwnerTargetSubtypeFieldRef nil="true" CLR_Type="System.String" />
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete</Permissions>
              <Tag CLR_Type="System.String"></Tag>
              <TargetDefaultSubtype nil="true" CLR_Type="System.String" />
              <ThereCardinality CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipCardinality">Many</ThereCardinality>
              <ThereRequired CLR_Type="System.Boolean">false</ThereRequired>
              <UpdateFields nil="true" />
            </Relationship>
          </Inserts>
        </Relationships>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <BusinessObjects Seq="1515" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <AuditedFieldsAndRelationships AggregateType="Set">
          <Inserts>
            <AuditedFieldsAndRelationship CLR_Type="System.String">StatusKeyword</AuditedFieldsAndRelationship>
          </Inserts>
        </AuditedFieldsAndRelationships>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <BusinessObjects Seq="1517" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <Fields AggregateType="Dictionary">
          <Inserts>
            <Field AggregateType="Object" FRS_ID="TaskWorkOrderStatus_Valid" DisplayName="TaskWorkOrderStatus_Valid">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">Text</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">TaskWorkOrderStatus_Valid</DisplayName>
              <FieldName CLR_Type="System.String">TaskWorkOrderStatus_Valid</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Component, Id, Validated</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">true</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">32</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">true</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
          </Inserts>
          <Updates>
            <Field AggregateType="Object" FRS_ID="TaskWorkOrderStatus" DisplayName="Task WorkOrder Status">
              <Updates>
                <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">
                  <First>Validated</First>
                  <Second>Simple</Second>
                </FieldType>
              </Updates>
            </Field>
          </Updates>
        </Fields>
        <ValidatedFields AggregateType="Dictionary">
          <Inserts>
            <ValidatedField AggregateType="Object" FRS_ID="TaskWorkOrderStatus">
              <Condition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
              <IsStateTransition CLR_Type="System.Boolean">false</IsStateTransition>
              <ValidatedIdFieldRef CLR_Type="System.String">TaskWorkOrderStatus_Valid</ValidatedIdFieldRef>
              <ValidatorRef CLR_Type="System.String">05eff5c15e3941d598f36fbde5a6384a</ValidatorRef>
            </ValidatedField>
          </Inserts>
        </ValidatedFields>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <BusinessObjects Seq="1518" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <Fields AggregateType="Dictionary">
          <Inserts>
            <Field AggregateType="Object" FRS_ID="ParentLink_Category" DisplayName="ParentLink_Category">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">Text</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">ParentLink_Category</DisplayName>
              <FieldName CLR_Type="System.String">ParentLink_Category</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Component, Link</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">100</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">true</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
            <Field AggregateType="Object" FRS_ID="ParentLink_RecID" DisplayName="ParentLink_RecID">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">Text</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">ParentLink_RecID</DisplayName>
              <FieldName CLR_Type="System.String">ParentLink_RecID</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Component, Id, Link</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">true</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">32</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">true</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
            <Field AggregateType="Object" FRS_ID="ParentLink" DisplayName="ParentLink">
              <ReadOnly CLR_Type="System.String">ReadOnly</ReadOnly>
              <RecIdSuffix CLR_Type="System.String">_RecID</RecIdSuffix>
              <CategorySuffix CLR_Type="System.String">_Category</CategorySuffix>
              <ValidSuffix CLR_Type="System.String">_Valid</ValidSuffix>
              <CurrencySuffix CLR_Type="System.String">_Currency</CurrencySuffix>
              <CurrencyValidSuffix CLR_Type="System.String">_CurrencyValid</CurrencyValidSuffix>
              <TimezoneSuffix CLR_Type="System.String">_timezone</TimezoneSuffix>
              <Annotations nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <CommonlySearched CLR_Type="System.Boolean">false</CommonlySearched>
              <ComputeHash CLR_Type="System.Boolean">true</ComputeHash>
              <DataType CLR_Type="MetaDataDefinition.DBDataType">Text</DataType>
              <Description CLR_Type="System.String"></Description>
              <DesignerName nil="true" CLR_Type="System.String" />
              <DisplayName CLR_Type="System.String">ParentLink</DisplayName>
              <FieldName CLR_Type="System.String">ParentLink</FieldName>
              <FieldType CLR_Type="MetaDataDefinition.Revisions.R1.FieldType">Link</FieldType>
              <Format nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.IFieldFormat" />
              <HideFromUI CLR_Type="System.Boolean">false</HideFromUI>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
              <IsInternal CLR_Type="System.Boolean">false</IsInternal>
              <IsLocalizable CLR_Type="System.Boolean">false</IsLocalizable>
              <Length CLR_Type="System.Int32">30</Length>
              <Link nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.LinkMetaData" />
              <Nullable CLR_Type="System.Boolean">true</Nullable>
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Scale CLR_Type="System.Int32">0</Scale>
              <SourceFieldName nil="true" CLR_Type="System.String" />
              <SourceTableRef nil="true" CLR_Type="System.String" />
              <Stored CLR_Type="System.Boolean">false</Stored>
              <System CLR_Type="System.Boolean">false</System>
              <Unique CLR_Type="System.Boolean">false</Unique>
              <IsContractField CLR_Type="System.Boolean">false</IsContractField>
            </Field>
          </Inserts>
        </Fields>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <BusinessObjects Seq="1519" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <Relationships AggregateType="Dictionary">
          <Inserts>
            <Relationship AggregateType="Object" FRS_ID="TenantEmailConfiguration#.XSC_TenantEmailTaskWorkOrderKeywordAssocTenantEmailConfiguration">
              <Binding CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipBinding">Contains</Binding>
              <CompositeTypeFilters AggregateType="List" CLR_Name="CompositeTypeFilter" />
              <Condition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
              <DesignerName CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeywordAssocTenantEmailConfiguration</DesignerName>
              <Direction CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipDirection">Reversed</Direction>
              <DisplayName CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeywordAssocTenantEmailConfiguration</DisplayName>
              <ForeignKey AggregateType="Object">
                <PKField CLR_Type="System.String">(other)RecId</PKField>
                <FKField CLR_Type="System.String">ParentLink_RecID</FKField>
                <FKCategoryField CLR_Type="System.String">ParentLink_Category</FKCategoryField>
              </ForeignKey>
              <FullTextSearchIndex CLR_Type="System.Boolean">false</FullTextSearchIndex>
              <HereCardinality CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipCardinality">Many</HereCardinality>
              <HerePreventDelete CLR_Type="System.Boolean">false</HerePreventDelete>
              <HereRequired CLR_Type="System.Boolean">false</HereRequired>
              <Implementation CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipImplementation">Constraint</Implementation>
              <IncludeObjectsFromFields nil="true" />
              <IsASymmetric CLR_Type="System.Boolean">false</IsASymmetric>
              <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
              <IsDeprecated CLR_Type="System.Boolean">false</IsDeprecated>
              <LinkTableFieldMapping nil="true" CLR_Type="System.Collections.Generic.Dictionary`2[[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]" />
              <LinkTableName CLR_Type="System.String"></LinkTableName>
              <OwnerTargetSubtypeFieldRef nil="true" CLR_Type="System.String" />
              <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
              <Tag CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeywordAssocTenantEmailConfiguration</Tag>
              <TargetDefaultSubtype nil="true" CLR_Type="System.String" />
              <ThereCardinality CLR_Type="MetaDataDefinition.Revisions.R1.RelationshipCardinality">One</ThereCardinality>
              <ThereRequired CLR_Type="System.Boolean">false</ThereRequired>
              <UpdateFields nil="true" />
            </Relationship>
          </Inserts>
        </Relationships>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <Forms Seq="1521" DbRevision="671">
  <Inserts>
    <Form FRS_ID="TenantEmailTaskWorkOrderKeyword" CLR_Type="MetaDataDefinition.Revisions.R1.FormMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#">
      <DefaultControlLabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
      <DefaultControlStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
      <FormStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
      <AuditObjectViews CLR_Type="System.Boolean">false</AuditObjectViews>
      <Cells AggregateType="List">
        <Cell AggregateType="Object" FRS_Index="0">
          <SectionBreak CLR_Type="System.Boolean">false</SectionBreak>
          <Row CLR_Type="System.Int32">0</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">control</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
        <Cell AggregateType="Object" FRS_Index="1">
          <SectionBreak CLR_Type="System.Boolean">true</SectionBreak>
          <Row CLR_Type="System.Int32">1</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">control1</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
        <Cell AggregateType="Object" FRS_Index="2">
          <SectionBreak CLR_Type="System.Boolean">false</SectionBreak>
          <Row CLR_Type="System.Int32">2</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">TaskWorkOrderStatus</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
        <Cell AggregateType="Object" FRS_Index="3">
          <SectionBreak CLR_Type="System.Boolean">false</SectionBreak>
          <Row CLR_Type="System.Int32">3</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">StatusKeyword</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
        <Cell AggregateType="Object" FRS_Index="4">
          <SectionBreak CLR_Type="System.Boolean">false</SectionBreak>
          <Row CLR_Type="System.Int32">4</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">CreatedBy</ControlName>
            <ControlName CLR_Type="System.String" FRS_Index="1">CreatedDateTime</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
        <Cell AggregateType="Object" FRS_Index="5">
          <SectionBreak CLR_Type="System.Boolean">false</SectionBreak>
          <Row CLR_Type="System.Int32">5</Row>
          <Column CLR_Type="System.Int32">0</Column>
          <RowSpan CLR_Type="System.Int32">1</RowSpan>
          <ColSpan CLR_Type="System.Int32">1</ColSpan>
          <ControlNames AggregateType="List">
            <ControlName CLR_Type="System.String" FRS_Index="0">LastModBy</ControlName>
            <ControlName CLR_Type="System.String" FRS_Index="1">LastModDateTime</ControlName>
          </ControlNames>
          <ControlPlacement CLR_Type="MetaDataDefinition.Revisions.R1.FormCellMetaData+ControlPlacementKind">Horizontal</ControlPlacement>
          <CellStyle CLR_Type="System.String"></CellStyle>
          <CellStyleExpression nil="true" CLR_Type="System.String" />
          <CellVAlign nil="true" CLR_Type="System.String" />
          <Margins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
        </Cell>
      </Cells>
      <Controls AggregateType="Dictionary">
        <Control AggregateType="Object" FRS_ID="control">
          <Label CLR_Type="System.String">Task WorkOrder Keyword</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">Label</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">1</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">control</Name>
          <Style CLR_Type="System.String">header</Style>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="control1">
          <Label CLR_Type="System.String"></Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">Label</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">control1</Name>
          <Style CLR_Type="System.String">hr</Style>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="TaskWorkOrderStatus">
          <FieldRef CLR_Type="System.String">TaskWorkOrderStatus</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">Task WorkOrder Status</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">Text</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">1</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">TaskWorkOrderStatus</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">25</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="StatusKeyword">
          <FieldRef CLR_Type="System.String">StatusKeyword</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">Status Keyword</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">Text</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">StatusKeyword</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">25</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="CreatedBy">
          <FieldRef CLR_Type="System.String">CreatedBy</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">Created By</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">ConstantText</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">CreatedBy</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="CreatedDateTime">
          <FieldRef CLR_Type="System.String">CreatedDateTime</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">On</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">ConstantText</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">CreatedDateTime</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="LastModBy">
          <FieldRef CLR_Type="System.String">LastModBy</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">Modified By</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">ConstantText</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">LastModBy</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
        <Control AggregateType="Object" FRS_ID="LastModDateTime">
          <FieldRef CLR_Type="System.String">LastModDateTime</FieldRef>
          <Searchable CLR_Type="System.Boolean">false</Searchable>
          <Editable CLR_Type="System.Boolean">false</Editable>
          <LabelPos CLR_Type="MetaDataDefinition.Revisions.R1.FormControlLabelPos">Left</LabelPos>
          <Label CLR_Type="System.String">On</Label>
          <LabelExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <LabelWrapType nil="true" CLR_Type="System.String" />
          <Category CLR_Type="MetaDataDefinition.Revisions.R1.FormControlCategory">ConstantText</Category>
          <customEditMask nil="true" CLR_Type="System.String" />
          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <editMask nil="true" CLR_Type="System.String" />
          <Height CLR_Type="System.Int32">0</Height>
          <LabelStyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Name CLR_Type="System.String">LastModDateTime</Name>
          <Style nil="true" CLR_Type="System.String" />
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <TabIndex CLR_Type="System.Int32">0</TabIndex>
          <Visible CLR_Type="System.Boolean">false</Visible>
          <VisibleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <Width CLR_Type="System.Int32">12</Width>
        </Control>
      </Controls>
      <DefaultCellMargins nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.HtmlMargins" />
      <Description CLR_Type="System.String"></Description>
      <DisplayName CLR_Type="System.String">TenantEmailTaskWorkOrderKeyword</DisplayName>
      <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
      <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
      <IsMobile CLR_Type="System.Boolean">false</IsMobile>
      <IsOutOfTheBox CLR_Type="System.Boolean">false</IsOutOfTheBox>
      <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
      <TenantMetaRevision CLR_Type="System.Int32">0</TenantMetaRevision>
      <Name CLR_Type="System.String">TenantEmailTaskWorkOrderKeyword</Name>
      <Perspective CLR_Type="System.String">(Base)</Perspective>
      <TableRef CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword#</TableRef>
      <Id CLR_Type="System.String">TenantEmailTaskWorkOrderKeyword</Id>
      <LastModified CLR_Type="System.DateTime">2021-09-09T08:13:43.073Z</LastModified>
      <ModifiedBy nil="true" CLR_Type="System.String" />
      <Revision CLR_Type="System.String">277627200FC0181BF60C9966D27C4FCD09C0B1E3</Revision>
    </Form>
  </Inserts>
</Forms>
      <Grids Seq="1522" DbRevision="671">
  <Inserts>
    <Grid FRS_ID="TenantEmailWorkOrderKeyword" CLR_Type="MetaDataDefinition.Revisions.R1.GridMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#">
      <Columns AggregateType="List">
        <Column AggregateType="Object" FRS_ID="TaskWorkOrderStatus" FRS_Index="0">
          <Name CLR_Type="System.String">Task WorkOrder Status</Name>
          <Alignment CLR_Type="MetaDataDefinition.Revisions.R1.GridColumnAlignment">Left</Alignment>
          <Width CLR_Type="System.Int32">160</Width>
          <FollowGridResize CLR_Type="System.Int32">0</FollowGridResize>
          <FieldRef CLR_Type="System.String">TaskWorkOrderStatus</FieldRef>
          <Id CLR_Type="System.String">0</Id>
          <Header CLR_Type="System.String">Task WorkOrder Status</Header>
          <WordWrap CLR_Type="System.Boolean">false</WordWrap>
          <Hidden CLR_Type="System.Boolean">false</Hidden>
          <AllowTips CLR_Type="System.Boolean">false</AllowTips>
          <LinkColumnConfig nil="true" CLR_Type="System.String" />
          <NotSortable CLR_Type="System.Boolean">false</NotSortable>
          <NotGroupedBy CLR_Type="System.Boolean">false</NotGroupedBy>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <ColumnRenderer nil="true" CLR_Type="System.String" />
          <FormattingExpr CLR_Type="System.String"></FormattingExpr>
          <ImageExpression CLR_Type="System.String"></ImageExpression>
          <ValueExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
        </Column>
        <Column AggregateType="Object" FRS_ID="StatusKeyword" FRS_Index="1">
          <Name CLR_Type="System.String">Status Keyword</Name>
          <Alignment CLR_Type="MetaDataDefinition.Revisions.R1.GridColumnAlignment">Left</Alignment>
          <Width CLR_Type="System.Int32">120</Width>
          <FollowGridResize CLR_Type="System.Int32">0</FollowGridResize>
          <FieldRef CLR_Type="System.String">StatusKeyword</FieldRef>
          <Id CLR_Type="System.String">1</Id>
          <Header CLR_Type="System.String">Status Keyword</Header>
          <WordWrap CLR_Type="System.Boolean">false</WordWrap>
          <Hidden CLR_Type="System.Boolean">false</Hidden>
          <AllowTips CLR_Type="System.Boolean">false</AllowTips>
          <LinkColumnConfig nil="true" CLR_Type="System.String" />
          <NotSortable CLR_Type="System.Boolean">false</NotSortable>
          <NotGroupedBy CLR_Type="System.Boolean">false</NotGroupedBy>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <ColumnRenderer nil="true" CLR_Type="System.String" />
          <FormattingExpr CLR_Type="System.String"></FormattingExpr>
          <ImageExpression CLR_Type="System.String"></ImageExpression>
          <ValueExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
        </Column>
        <Column AggregateType="Object" FRS_ID="LastModBy" FRS_Index="2">
          <Name CLR_Type="System.String">Modified By</Name>
          <Alignment CLR_Type="MetaDataDefinition.Revisions.R1.GridColumnAlignment">Left</Alignment>
          <Width CLR_Type="System.Int32">100</Width>
          <FollowGridResize CLR_Type="System.Int32">0</FollowGridResize>
          <FieldRef CLR_Type="System.String">LastModBy</FieldRef>
          <Id CLR_Type="System.String">2</Id>
          <Header CLR_Type="System.String">Modified By</Header>
          <WordWrap CLR_Type="System.Boolean">false</WordWrap>
          <Hidden CLR_Type="System.Boolean">false</Hidden>
          <AllowTips CLR_Type="System.Boolean">false</AllowTips>
          <LinkColumnConfig nil="true" CLR_Type="System.String" />
          <NotSortable CLR_Type="System.Boolean">false</NotSortable>
          <NotGroupedBy CLR_Type="System.Boolean">false</NotGroupedBy>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <ColumnRenderer nil="true" CLR_Type="System.String" />
          <FormattingExpr CLR_Type="System.String"></FormattingExpr>
          <ImageExpression CLR_Type="System.String"></ImageExpression>
          <ValueExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
        </Column>
        <Column AggregateType="Object" FRS_ID="LastModDateTime" FRS_Index="3">
          <Name CLR_Type="System.String">Modified On</Name>
          <Alignment CLR_Type="MetaDataDefinition.Revisions.R1.GridColumnAlignment">Left</Alignment>
          <Width CLR_Type="System.Int32">100</Width>
          <FollowGridResize CLR_Type="System.Int32">0</FollowGridResize>
          <FieldRef CLR_Type="System.String">LastModDateTime</FieldRef>
          <Id CLR_Type="System.String">3</Id>
          <Header CLR_Type="System.String">Modified On</Header>
          <WordWrap CLR_Type="System.Boolean">false</WordWrap>
          <Hidden CLR_Type="System.Boolean">false</Hidden>
          <AllowTips CLR_Type="System.Boolean">false</AllowTips>
          <LinkColumnConfig nil="true" CLR_Type="System.String" />
          <NotSortable CLR_Type="System.Boolean">false</NotSortable>
          <NotGroupedBy CLR_Type="System.Boolean">true</NotGroupedBy>
          <StyleExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <ColumnRenderer nil="true" CLR_Type="System.String" />
          <FormattingExpr CLR_Type="System.String"></FormattingExpr>
          <ImageExpression CLR_Type="System.String"></ImageExpression>
          <ValueExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
        </Column>
      </Columns>
      <Condition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
      <DefaultGroupByName CLR_Type="System.String"></DefaultGroupByName>
      <DefaultPageSize AggregateType="Object">
        <Workspace CLR_Type="System.Int32">0</Workspace>
        <Dashboard CLR_Type="System.Int32">10</Dashboard>
        <Popup CLR_Type="System.Int32">10</Popup>
        <ChildPanel CLR_Type="System.Int32">10</ChildPanel>
      </DefaultPageSize>
      <DefaultSortDir CLR_Type="System.String">ASC</DefaultSortDir>
      <DefaultSortField CLR_Type="System.String"></DefaultSortField>
      <DefaultSortFields nil="true" />
      <Description CLR_Type="System.String"></Description>
      <DisplayName nil="true" CLR_Type="System.String" />
      <Editable CLR_Type="System.Boolean">true</Editable>
      <FilterFields nil="true" />
      <IsCommonlyUsed CLR_Type="System.Boolean">false</IsCommonlyUsed>
      <IsFrsOwned CLR_Type="System.Boolean">false</IsFrsOwned>
      <IsOutOfTheBox CLR_Type="System.Boolean">false</IsOutOfTheBox>
      <Joins nil="true" />
      <MaxRows CLR_Type="System.Int32">1000</MaxRows>
      <Permissions CLR_Type="MetaDataDefinition.Revisions.R1.Permissions">Delete, Update</Permissions>
      <TenantMetaRevision CLR_Type="System.Int32">0</TenantMetaRevision>
      <Name CLR_Type="System.String">TenantEmailWorkOrderKeyword</Name>
      <OpenInNewTab CLR_Type="System.Boolean">false</OpenInNewTab>
      <Perspective CLR_Type="System.String">(Base)</Perspective>
      <RelatedObject nil="true" CLR_Type="System.String" />
      <RowFormattingExpr nil="true" CLR_Type="System.String" />
      <System CLR_Type="System.Boolean">false</System>
      <TableRef CLR_Type="System.String">XSC_TenantEmailTaskWorkOrderKeyword#</TableRef>
      <TemplateName nil="true" CLR_Type="System.String" />
      <Id CLR_Type="System.String">TenantEmailWorkOrderKeyword</Id>
      <LastModified CLR_Type="System.DateTime">2021-09-09T08:18:31.267Z</LastModified>
      <ModifiedBy nil="true" CLR_Type="System.String" />
      <Revision CLR_Type="System.String">715200A5C68EAC81A6D5B09AE995A521008569F1</Revision>
    </Grid>
  </Inserts>
</Grids>
      <Layouts Seq="1523" DbRevision="671">
  <Updates>
    <Layout FRS_ID="TenantEmailConfiguration" CLR_Type="MetaDataDefinition.Revisions.R1.LayoutMetaData" ObjectType="TenantEmailConfiguration#" DisplayName="TenantEmailConfiguration">
      <Updates>
        <TenantMetaRevision CLR_Type="System.Int32">
          <First>0</First>
          <Second>-1</Second>
        </TenantMetaRevision>
        <Views AggregateType="Set">
          <Updates>
            <View AggregateType="Object" FRS_ID="formView" ObjectType="TenantEmailConfiguration#" DisplayName="formView">
              <Updates>
                <ChildPanels AggregateType="List">
                  <Inserts>
                    <ChildPanel AggregateType="Object" FRS_Index="11" ObjectType="TenantEmailConfiguration#" DisplayName="Custom">
                      <Closable CLR_Type="System.Boolean">false</Closable>
                      <CssClass nil="true" CLR_Type="System.String" />
                      <DisplayName CLR_Type="System.String">Custom</DisplayName>
                      <GridFilterCondition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                      <GridName CLR_Type="System.String"></GridName>
                      <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                      <InitiallyVisible AggregateType="Object" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" ObjectType="TenantEmailConfiguration#" ExpressionType="System.Boolean">
                        <Description nil="true" CLR_Type="System.String" />
                        <FieldRefs AggregateType="List" />
                        <IsFullExpression CLR_Type="System.Boolean">false</IsFullExpression>
                        <Name nil="true" CLR_Type="System.String" />
                        <Tree AggregateType="Object">
                          <Value CLR_Type="System.Boolean">false</Value>
                          <LongImage nil="true" CLR_Type="System.String" />
                          <IsHex CLR_Type="System.Boolean">false</IsHex>
                          <IsVerbatimText CLR_Type="System.Boolean">false</IsVerbatimText>
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData+NodeKind">Literal</Kind>
                        </Tree>
                        <ValidationStatus CLR_Type="MetaDataDefinition.Revisions.R1.ReadOnly.ExpressionValidationStatus">Ok</ValidationStatus>
                      </InitiallyVisible>
                      <IsTab CLR_Type="System.Boolean">true</IsTab>
                      <LayoutName nil="true" CLR_Type="System.String" />
                      <MainForms AggregateType="Dictionary">
                        <MainForm CLR_Type="System.String" FRS_ID="TenantEmailConfiguration#">TenantEmailConfiguration.Custom</MainForm>
                      </MainForms>
                      <PluginName nil="true" CLR_Type="System.String" />
                      <Rel2Name nil="true" CLR_Type="System.String" />
                      <RelationshipTag nil="true" CLR_Type="System.String" />
                      <RollupRels AggregateType="List" />
                      <PluginParams nil="true" />
                      <SearchCondition nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                      <ShowTabCount CLR_Type="System.Boolean">false</ShowTabCount>
                      <TableRef CLR_Type="System.String">TenantEmailConfiguration#</TableRef>
                      <Toolbars AggregateType="List" CLR_Name="Toolbar">
                        <Toolbar AggregateType="Object" FRS_Index="0">
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                          <HideText CLR_Type="System.Boolean">false</HideText>
                          <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                          <Text CLR_Type="System.String">New Record Menu</Text>
                          <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                          <Icon CLR_Type="System.String">../common/SaasNewRecordMenu.png</Icon>
                          <ToolTip CLR_Type="System.String">New Record Menu</ToolTip>
                          <ActionId nil="true" CLR_Type="System.String" />
                          <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">NewRecordMenu</Command>
                          <Submenus AggregateType="List" CLR_Name="Submenu" />
                          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <Private CLR_Type="System.Boolean">false</Private>
                          <Parameter1 CLR_Type="System.String"></Parameter1>
                          <Parameter2 nil="true" CLR_Type="System.String" />
                          <ShortcutKey nil="true" CLR_Type="System.String" />
                        </Toolbar>
                        <Toolbar AggregateType="Object" FRS_Index="1">
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                          <HideText CLR_Type="System.Boolean">false</HideText>
                          <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                          <Text CLR_Type="System.String">Delete</Text>
                          <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                          <Icon CLR_Type="System.String">../common/SaasDeleteRecord.png</Icon>
                          <ToolTip CLR_Type="System.String">Delete Record</ToolTip>
                          <ActionId nil="true" CLR_Type="System.String" />
                          <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">DeleteRecord</Command>
                          <Submenus AggregateType="List" CLR_Name="Submenu" />
                          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <Private CLR_Type="System.Boolean">false</Private>
                          <Parameter1 CLR_Type="System.String"></Parameter1>
                          <Parameter2 nil="true" CLR_Type="System.String" />
                          <ShortcutKey nil="true" CLR_Type="System.String" />
                        </Toolbar>
                        <Toolbar AggregateType="Object" FRS_Index="2">
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                          <HideText CLR_Type="System.Boolean">false</HideText>
                          <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                          <Text CLR_Type="System.String">Link</Text>
                          <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                          <Icon CLR_Type="System.String">../common/SaasLinkRecord.png</Icon>
                          <ToolTip CLR_Type="System.String">Link Record</ToolTip>
                          <ActionId nil="true" CLR_Type="System.String" />
                          <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">LinkRecord</Command>
                          <Submenus AggregateType="List" CLR_Name="Submenu" />
                          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <Private CLR_Type="System.Boolean">false</Private>
                          <Parameter1 CLR_Type="System.String"></Parameter1>
                          <Parameter2 nil="true" CLR_Type="System.String" />
                          <ShortcutKey nil="true" CLR_Type="System.String" />
                        </Toolbar>
                        <Toolbar AggregateType="Object" FRS_Index="3">
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                          <HideText CLR_Type="System.Boolean">false</HideText>
                          <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                          <Text CLR_Type="System.String">Unlink</Text>
                          <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                          <Icon CLR_Type="System.String">../common/SaasUnlinkRecord.png</Icon>
                          <ToolTip CLR_Type="System.String">Unlink Record</ToolTip>
                          <ActionId nil="true" CLR_Type="System.String" />
                          <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">UnlinkRecord</Command>
                          <Submenus AggregateType="List" CLR_Name="Submenu" />
                          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <Private CLR_Type="System.Boolean">false</Private>
                          <Parameter1 CLR_Type="System.String"></Parameter1>
                          <Parameter2 nil="true" CLR_Type="System.String" />
                          <ShortcutKey nil="true" CLR_Type="System.String" />
                        </Toolbar>
                        <Toolbar AggregateType="Object" FRS_Index="4">
                          <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                          <HideText CLR_Type="System.Boolean">false</HideText>
                          <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                          <Text CLR_Type="System.String">Go to</Text>
                          <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                          <Icon CLR_Type="System.String">../common/SaasToFullRecord.png</Icon>
                          <ToolTip CLR_Type="System.String">To Full Record</ToolTip>
                          <ActionId nil="true" CLR_Type="System.String" />
                          <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">ToFullRecord</Command>
                          <Submenus AggregateType="List" CLR_Name="Submenu" />
                          <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                          <Private CLR_Type="System.Boolean">false</Private>
                          <Parameter1 CLR_Type="System.String"></Parameter1>
                          <Parameter2 nil="true" CLR_Type="System.String" />
                          <ShortcutKey nil="true" CLR_Type="System.String" />
                        </Toolbar>
                      </Toolbars>
                    </ChildPanel>
                  </Inserts>
                  <Updates>
                    <ChildPanel AggregateType="Object" FRS_Index="5" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
                      <Deletes>
                        <RollupRels nil="true" />
                      </Deletes>
                      <Inserts>
                        <RollupRels AggregateType="List" />
                      </Inserts>
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>Task WorkOrder Status Keyword</First>
                          <Second>FRS Approval Status Keyword</Second>
                        </DisplayName>
                        <GridName CLR_Type="System.String">
                          <First>TenantEmailWorkOrderKeyword</First>
                          <Second>TenantEmailFRSApprovalKeyword</Second>
                        </GridName>
                        <MainForms AggregateType="Dictionary">
                          <Deletes>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailFRSApprovalKeyword#">TenantEmailFRSApprovalKeyword</MainForm>
                          </Deletes>
                          <Inserts>
                            <MainForm CLR_Type="System.String" FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#">TenantEmailTaskWorkOrderKeyword</MainForm>
                          </Inserts>
                        </MainForms>
                        <RelationshipTag CLR_Type="System.String">
                          <First>XSC_TenantEmailTaskWorkOrderKeywordAssocTenantEmailConfiguration</First>
                          <Second></Second>
                        </RelationshipTag>
                        <ShowTabCount CLR_Type="System.Boolean">
                          <First>false</First>
                          <Second>true</Second>
                        </ShowTabCount>
                        <TableRef CLR_Type="System.String">
                          <First>XSC_TenantEmailTaskWorkOrderKeyword#</First>
                          <Second>TenantEmailFRSApprovalKeyword#</Second>
                        </TableRef>
                        <Toolbars AggregateType="List" CLR_Name="Toolbar">
                          <Inserts>
                            <Toolbar AggregateType="Object" FRS_Index="4">
                              <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                              <HideText CLR_Type="System.Boolean">false</HideText>
                              <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                              <Text CLR_Type="System.String">Go to</Text>
                              <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                              <Icon CLR_Type="System.String">../common/SaasToFullRecord.png</Icon>
                              <ToolTip CLR_Type="System.String">To Full Record</ToolTip>
                              <ActionId nil="true" CLR_Type="System.String" />
                              <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">ToFullRecord</Command>
                              <Submenus AggregateType="List" CLR_Name="Submenu" />
                              <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                              <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                              <Private CLR_Type="System.Boolean">false</Private>
                              <Parameter1 CLR_Type="System.String"></Parameter1>
                              <Parameter2 CLR_Type="System.String"></Parameter2>
                              <ShortcutKey nil="true" CLR_Type="System.String" />
                            </Toolbar>
                          </Inserts>
                          <Updates>
                            <Toolbar AggregateType="Object" FRS_Index="0">
                              <Deletes>
                                <Parameter2 nil="true" CLR_Type="System.String" />
                              </Deletes>
                              <Inserts>
                                <Parameter2 CLR_Type="System.String"></Parameter2>
                              </Inserts>
                              <Updates>
                                <Text CLR_Type="System.String">
                                  <First>New Record Menu</First>
                                  <Second>New</Second>
                                </Text>
                                <Icon CLR_Type="System.String">
                                  <First>../common/SaasNewRecordMenu.png</First>
                                  <Second>../common/SaasNewRecord.png</Second>
                                </Icon>
                                <ToolTip CLR_Type="System.String">
                                  <First>New Record Menu</First>
                                  <Second>New</Second>
                                </ToolTip>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>NewRecordMenu</First>
                                  <Second>NewRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="1">
                              <Deletes>
                                <Parameter2 nil="true" CLR_Type="System.String" />
                              </Deletes>
                              <Inserts>
                                <Parameter2 CLR_Type="System.String"></Parameter2>
                              </Inserts>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="2">
                              <Deletes>
                                <Text nil="true" CLR_Type="System.String" />
                                <Icon nil="true" CLR_Type="System.String" />
                                <ToolTip nil="true" CLR_Type="System.String" />
                                <Submenus nil="true" CLR_Name="Submenu" />
                                <Parameter1 nil="true" CLR_Type="System.String" />
                                <Parameter2 nil="true" CLR_Type="System.String" />
                              </Deletes>
                              <Inserts>
                                <Text CLR_Type="System.String">Link</Text>
                                <Icon CLR_Type="System.String">../common/SaasLinkRecord.png</Icon>
                                <ToolTip CLR_Type="System.String">Link Record</ToolTip>
                                <Submenus AggregateType="List" CLR_Name="Submenu" />
                                <Parameter1 CLR_Type="System.String"></Parameter1>
                                <Parameter2 CLR_Type="System.String"></Parameter2>
                              </Inserts>
                              <Updates>
                                <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">
                                  <First>Command</First>
                                  <Second>Filler</Second>
                                </Kind>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>LinkRecord</First>
                                  <Second>NewRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="3">
                              <Deletes>
                                <Parameter1 nil="true" CLR_Type="System.String" />
                                <Parameter2 nil="true" CLR_Type="System.String" />
                              </Deletes>
                              <Inserts>
                                <Parameter1 CLR_Type="System.String"></Parameter1>
                                <Parameter2 CLR_Type="System.String"></Parameter2>
                              </Inserts>
                              <Updates>
                                <Text CLR_Type="System.String">
                                  <First>Unlink</First>
                                  <Second>Action Menu</Second>
                                </Text>
                                <Icon CLR_Type="System.String">
                                  <First>../common/SaasUnlinkRecord.png</First>
                                  <Second>../common/SaasActionMenu.png</Second>
                                </Icon>
                                <ToolTip CLR_Type="System.String">
                                  <First>Unlink Record</First>
                                  <Second>Action Menu</Second>
                                </ToolTip>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>UnlinkRecord</First>
                                  <Second>ActionMenu</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                          </Updates>
                        </Toolbars>
                      </Updates>
                    </ChildPanel>
                    <ChildPanel AggregateType="Object" FRS_Index="6" ObjectType="TenantEmailFRSApprovalKeyword#" DisplayName="FRS Approval Status Keyword">
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>FRS Approval Status Keyword</First>
                          <Second>Ignore message with subject</Second>
                        </DisplayName>
                        <GridName CLR_Type="System.String">
                          <First>TenantEmailFRSApprovalKeyword</First>
                          <Second>TenantEmailSubjectLine</Second>
                        </GridName>
                        <MainForms AggregateType="Dictionary">
                          <Deletes>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailSubjectLine#">TenantEmailSubjectLine</MainForm>
                          </Deletes>
                          <Inserts>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailFRSApprovalKeyword#">TenantEmailFRSApprovalKeyword</MainForm>
                          </Inserts>
                        </MainForms>
                        <RelationshipTag CLR_Type="System.String">
                          <First></First>
                          <Second>IgnoreSubjectLine</Second>
                        </RelationshipTag>
                        <TableRef CLR_Type="System.String">
                          <First>TenantEmailFRSApprovalKeyword#</First>
                          <Second>TenantEmailSubjectLine#</Second>
                        </TableRef>
                      </Updates>
                    </ChildPanel>
                    <ChildPanel AggregateType="Object" FRS_Index="7" ObjectType="TenantEmailSubjectLine#" DisplayName="Ignore message with subject">
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>Ignore message with subject</First>
                          <Second>Delivery failure notification</Second>
                        </DisplayName>
                        <RelationshipTag CLR_Type="System.String">
                          <First>IgnoreSubjectLine</First>
                          <Second>Delivery</Second>
                        </RelationshipTag>
                      </Updates>
                    </ChildPanel>
                    <ChildPanel AggregateType="Object" FRS_Index="8" ObjectType="TenantEmailSubjectLine#" DisplayName="Delivery failure notification">
                      <Deletes>
                        <RollupRels AggregateType="List" />
                      </Deletes>
                      <Inserts>
                        <RollupRels nil="true" />
                      </Inserts>
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>Delivery failure notification</First>
                          <Second>Object Name Mapping</Second>
                        </DisplayName>
                        <GridName CLR_Type="System.String">
                          <First>TenantEmailSubjectLine</First>
                          <Second>TenantEmailBONameMapping</Second>
                        </GridName>
                        <MainForms AggregateType="Dictionary">
                          <Deletes>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailBONameMapping#">TenantEmailBONameMapping</MainForm>
                          </Deletes>
                          <Inserts>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailSubjectLine#">TenantEmailSubjectLine</MainForm>
                          </Inserts>
                        </MainForms>
                        <RelationshipTag CLR_Type="System.String">
                          <First>Delivery</First>
                          <Second>TenantEmailConfigContainsEmailObjectNameMapping</Second>
                        </RelationshipTag>
                        <TableRef CLR_Type="System.String">
                          <First>TenantEmailSubjectLine#</First>
                          <Second>TenantEmailBONameMapping#</Second>
                        </TableRef>
                        <Toolbars AggregateType="List" CLR_Name="Toolbar">
                          <Updates>
                            <Toolbar AggregateType="Object" FRS_Index="0">
                              <Updates>
                                <UseCustomText CLR_Type="System.Boolean">
                                  <First>false</First>
                                  <Second>true</Second>
                                </UseCustomText>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="2">
                              <Deletes>
                                <Text CLR_Type="System.String">Go to</Text>
                                <Icon CLR_Type="System.String">../common/SaasToFullRecord.png</Icon>
                                <ToolTip CLR_Type="System.String">To Full Record</ToolTip>
                                <Submenus AggregateType="List" CLR_Name="Submenu" />
                                <Parameter1 CLR_Type="System.String"></Parameter1>
                              </Deletes>
                              <Inserts>
                                <Text nil="true" CLR_Type="System.String" />
                                <Icon nil="true" CLR_Type="System.String" />
                                <ToolTip nil="true" CLR_Type="System.String" />
                                <Submenus nil="true" CLR_Name="Submenu" />
                                <Parameter1 nil="true" CLR_Type="System.String" />
                              </Inserts>
                              <Updates>
                                <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">
                                  <First>Filler</First>
                                  <Second>Command</Second>
                                </Kind>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>NewRecord</First>
                                  <Second>ToFullRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="3">
                              <Deletes>
                                <Text nil="true" CLR_Type="System.String" />
                                <Icon nil="true" CLR_Type="System.String" />
                                <ToolTip nil="true" CLR_Type="System.String" />
                                <Submenus nil="true" CLR_Name="Submenu" />
                              </Deletes>
                              <Inserts>
                                <Text CLR_Type="System.String">Action Menu</Text>
                                <Icon CLR_Type="System.String">../common/SaasActionMenu.png</Icon>
                                <ToolTip CLR_Type="System.String">Action Menu</ToolTip>
                                <Submenus AggregateType="List" CLR_Name="Submenu" />
                              </Inserts>
                              <Updates>
                                <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">
                                  <First>Command</First>
                                  <Second>Filler</Second>
                                </Kind>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>ActionMenu</First>
                                  <Second>NewRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                          </Updates>
                        </Toolbars>
                      </Updates>
                    </ChildPanel>
                    <ChildPanel AggregateType="Object" FRS_Index="9" ObjectType="TenantEmailBONameMapping#" DisplayName="Object Name Mapping">
                      <Deletes>
                        <InitiallyVisible AggregateType="Object" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" ObjectType="TenantEmailConfiguration#" ExpressionType="System.Boolean">
                          <Description nil="true" CLR_Type="System.String" />
                          <FieldRefs AggregateType="List" />
                          <IsFullExpression CLR_Type="System.Boolean">false</IsFullExpression>
                          <Name nil="true" CLR_Type="System.String" />
                          <Tree AggregateType="Object">
                            <Value CLR_Type="System.Boolean">false</Value>
                            <LongImage nil="true" CLR_Type="System.String" />
                            <IsHex CLR_Type="System.Boolean">false</IsHex>
                            <IsVerbatimText CLR_Type="System.Boolean">false</IsVerbatimText>
                            <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData+NodeKind">Literal</Kind>
                          </Tree>
                          <ValidationStatus CLR_Type="MetaDataDefinition.Revisions.R1.ReadOnly.ExpressionValidationStatus">Ok</ValidationStatus>
                        </InitiallyVisible>
                      </Deletes>
                      <Inserts>
                        <InitiallyVisible nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                      </Inserts>
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>Object Name Mapping</First>
                          <Second>Audit History</Second>
                        </DisplayName>
                        <GridName CLR_Type="System.String">
                          <First>TenantEmailBONameMapping</First>
                          <Second>AuditHistory_TenantEmailConfiguration</Second>
                        </GridName>
                        <MainForms AggregateType="Dictionary">
                          <Inserts>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailBONameMapping#">TenantEmailBONameMapping</MainForm>
                          </Inserts>
                        </MainForms>
                        <RelationshipTag CLR_Type="System.String">
                          <First>TenantEmailConfigContainsEmailObjectNameMapping</First>
                          <Second></Second>
                        </RelationshipTag>
                        <TableRef CLR_Type="System.String">
                          <First>TenantEmailBONameMapping#</First>
                          <Second>Audit_TenantEmailConfiguration#</Second>
                        </TableRef>
                        <Toolbars AggregateType="List" CLR_Name="Toolbar">
                          <Deletes>
                            <Toolbar AggregateType="Object" FRS_Index="4">
                              <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">Command</Kind>
                              <HideText CLR_Type="System.Boolean">false</HideText>
                              <UseCustomText CLR_Type="System.Boolean">false</UseCustomText>
                              <Text CLR_Type="System.String">Go to</Text>
                              <HideIcon CLR_Type="System.Boolean">false</HideIcon>
                              <Icon CLR_Type="System.String">../common/SaasToFullRecord.png</Icon>
                              <ToolTip CLR_Type="System.String">To Full Record</ToolTip>
                              <ActionId nil="true" CLR_Type="System.String" />
                              <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">ToFullRecord</Command>
                              <Submenus AggregateType="List" CLR_Name="Submenu" />
                              <HiddenExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                              <DisabledExpression nil="true" CLR_Type="MetaDataDefinition.Revisions.R1.ExpressionMetaData" />
                              <Private CLR_Type="System.Boolean">false</Private>
                              <Parameter1 CLR_Type="System.String"></Parameter1>
                              <Parameter2 nil="true" CLR_Type="System.String" />
                              <ShortcutKey nil="true" CLR_Type="System.String" />
                            </Toolbar>
                          </Deletes>
                          <Updates>
                            <Toolbar AggregateType="Object" FRS_Index="0">
                              <Updates>
                                <UseCustomText CLR_Type="System.Boolean">
                                  <First>true</First>
                                  <Second>false</Second>
                                </UseCustomText>
                                <Text CLR_Type="System.String">
                                  <First>New</First>
                                  <Second>New Record Menu</Second>
                                </Text>
                                <Icon CLR_Type="System.String">
                                  <First>../common/SaasNewRecord.png</First>
                                  <Second>../common/SaasNewRecordMenu.png</Second>
                                </Icon>
                                <ToolTip CLR_Type="System.String">
                                  <First>New</First>
                                  <Second>New Record Menu</Second>
                                </ToolTip>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>NewRecord</First>
                                  <Second>NewRecordMenu</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="2">
                              <Updates>
                                <Text CLR_Type="System.String">
                                  <First>Go to</First>
                                  <Second>Link</Second>
                                </Text>
                                <Icon CLR_Type="System.String">
                                  <First>../common/SaasToFullRecord.png</First>
                                  <Second>../common/SaasLinkRecord.png</Second>
                                </Icon>
                                <ToolTip CLR_Type="System.String">
                                  <First>To Full Record</First>
                                  <Second>Link Record</Second>
                                </ToolTip>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>ToFullRecord</First>
                                  <Second>LinkRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                            <Toolbar AggregateType="Object" FRS_Index="3">
                              <Deletes>
                                <Text CLR_Type="System.String">Unlink</Text>
                                <Icon CLR_Type="System.String">../common/SaasUnlinkRecord.png</Icon>
                                <ToolTip CLR_Type="System.String">Unlink Record</ToolTip>
                                <Submenus AggregateType="List" CLR_Name="Submenu" />
                                <Parameter1 CLR_Type="System.String"></Parameter1>
                              </Deletes>
                              <Inserts>
                                <Text nil="true" CLR_Type="System.String" />
                                <Icon nil="true" CLR_Type="System.String" />
                                <ToolTip nil="true" CLR_Type="System.String" />
                                <Submenus nil="true" CLR_Name="Submenu" />
                                <Parameter1 nil="true" CLR_Type="System.String" />
                              </Inserts>
                              <Updates>
                                <Kind CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarItemKind">
                                  <First>Filler</First>
                                  <Second>Command</Second>
                                </Kind>
                                <Command CLR_Type="MetaDataDefinition.Revisions.R1.ObjectToolbarCommand">
                                  <First>NewRecord</First>
                                  <Second>UnlinkRecord</Second>
                                </Command>
                              </Updates>
                            </Toolbar>
                          </Updates>
                        </Toolbars>
                      </Updates>
                    </ChildPanel>
                    <ChildPanel AggregateType="Object" FRS_Index="10" ObjectType="Audit_TenantEmailConfiguration#" DisplayName="Audit History">
                      <Deletes>
                        <RelationshipTag nil="true" CLR_Type="System.String" />
                      </Deletes>
                      <Inserts>
                        <RelationshipTag CLR_Type="System.String"></RelationshipTag>
                      </Inserts>
                      <Updates>
                        <DisplayName CLR_Type="System.String">
                          <First>Audit History</First>
                          <Second>Custom</Second>
                        </DisplayName>
                        <GridName CLR_Type="System.String">
                          <First>AuditHistory_TenantEmailConfiguration</First>
                          <Second></Second>
                        </GridName>
                        <MainForms AggregateType="Dictionary">
                          <Deletes>
                            <MainForm CLR_Type="System.String" FRS_ID="TenantEmailConfiguration#">TenantEmailConfiguration.Custom</MainForm>
                          </Deletes>
                        </MainForms>
                        <ShowTabCount CLR_Type="System.Boolean">
                          <First>true</First>
                          <Second>false</Second>
                        </ShowTabCount>
                        <TableRef CLR_Type="System.String">
                          <First>Audit_TenantEmailConfiguration#</First>
                          <Second>TenantEmailConfiguration#</Second>
                        </TableRef>
                      </Updates>
                    </ChildPanel>
                  </Updates>
                </ChildPanels>
              </Updates>
            </View>
          </Updates>
        </Views>
      </Updates>
    </Layout>
  </Updates>
</Layouts>
      <BusinessObjects Seq="1524" DbRevision="671">
  <Updates>
    <BusinessObject FRS_ID="XSC_TenantEmailTaskWorkOrderKeyword#" CLR_Type="MetaDataDefinition.Revisions.R1.TableMetaData" ObjectType="XSC_TenantEmailTaskWorkOrderKeyword#" DisplayName="Task WorkOrder Status Keyword">
      <Updates>
        <ValidatedFields AggregateType="Dictionary">
          <Updates>
            <ValidatedField AggregateType="Object" FRS_ID="TaskWorkOrderStatus">
              <Updates>
                <ValidatorRef CLR_Type="System.String">
                  <First>029e6ed293114d82b04e6fc0246e633d</First>
                  <Second>05eff5c15e3941d598f36fbde5a6384a</Second>
                </ValidatorRef>
              </Updates>
            </ValidatedField>
          </Updates>
        </ValidatedFields>
      </Updates>
    </BusinessObject>
  </Updates>
</BusinessObjects>
      <Frs_def_integration_connections Seq="1525" DbRevision="671">
  <Updates>
    <Frs_def_integration_connection FRS_ID="ff898400f6c3475eb18b4be319a3a26a" DisplayName="XSC_Mail_Parser_con">
      <Updates>
        <XSLT>
          <First>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
var evaluate = true;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var ticketType = matches[i].split(splitRegExp)[0].trim();
				var ticketNumber = matches[i].split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var ticketType = matches[i].split(splitRegExp)[0].trim();
					var ticketNumber = matches[i].split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("Assignment:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
			
			if(journalParentLink_Category == "Task.WorkOrder"){
				console.debug("Task.WorkOrder: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('XSC_TenantEmailTaskWorkOrderKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("WorkOrder Status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskWorkOrderStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#WorkOrder', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
	else
	{
		var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
	}	

console.debug("XSC Script Completed");

</First>
          <Second>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var ticketType = matches[i].split(splitRegExp)[0].trim();
				var ticketNumber = matches[i].split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var ticketType = matches[i].split(splitRegExp)[0].trim();
					var ticketNumber = matches[i].split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
else
{
	var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
}	
console.debug("XSC Script Completed");

</Second>
        </XSLT>
      </Updates>
    </Frs_def_integration_connection>
  </Updates>
</Frs_def_integration_connections>
      <Frs_def_integration_connections Seq="1544" DbRevision="671">
  <Updates>
    <Frs_def_integration_connection FRS_ID="ff898400f6c3475eb18b4be319a3a26a" DisplayName="XSC_Mail_Parser_con">
      <Updates>
        <XSLT>
          <First>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
var evaluate = true;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var matchestrimmed = matches[i].trim();
				var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
				var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var matchestrimmed = matches[i].trim();
					var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
					var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("Assignment:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
			
			if(journalParentLink_Category == "Task.WorkOrder"){
				console.debug("Task.WorkOrder: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('XSC_TenantEmailTaskWorkOrderKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("WorkOrder Status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskWorkOrderStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#WorkOrder', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
	else
	{
		var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
	}	

console.debug("XSC Script Completed");

</First>
          <Second>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
var evaluate = true;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var ticketType = matches[i].split(splitRegExp)[0].trim();
				var ticketNumber = matches[i].split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var ticketType = matches[i].split(splitRegExp)[0].trim();
					var ticketNumber = matches[i].split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("Assignment:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
			
			if(journalParentLink_Category == "Task.WorkOrder"){
				console.debug("Task.WorkOrder: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('XSC_TenantEmailTaskWorkOrderKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("WorkOrder Status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskWorkOrderStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#WorkOrder', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
	else
	{
		var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
	}	

console.debug("XSC Script Completed");

</Second>
        </XSLT>
      </Updates>
    </Frs_def_integration_connection>
  </Updates>
</Frs_def_integration_connections>
      <Frs_def_integration_connections Seq="1547" DbRevision="671">
  <Updates>
    <Frs_def_integration_connection FRS_ID="ff898400f6c3475eb18b4be319a3a26a" DisplayName="XSC_Mail_Parser_con">
      <Updates>
        <XSLT>
          <First>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
var evaluate = true;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalOwnerEmail = CurrentJournalEmployee.Fields["PrimaryEmail"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalOwnerEmail = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var matchestrimmed = matches[i].trim();
				var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
				var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var matchestrimmed = matches[i].trim();
					var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
					var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; (journalOwner == RelatedTicket.Fields["Owner"] || journalOwnerEmail == RelatedTicket.Fields["Owner"])){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwnerEmail == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("Assignment:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
			
			if(journalParentLink_Category == "Task.WorkOrder"){
				console.debug("Task.WorkOrder: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('XSC_TenantEmailTaskWorkOrderKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("WorkOrder Status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskWorkOrderStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#WorkOrder', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
	else
	{
		var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
	}	

console.debug("XSC Script Completed");

</First>
          <Second>var CurrentJournal = Get("Journal#Email", "$(RecId)");
var CurrentJournalFromAddr = CurrentJournal.Fields["FromAddr"];
var CurrentJournalSubject = CurrentJournal.Fields["Subject"];
var RelatedTicket = null;
var evaluate = true;
//variables for update
var journalCreatedBy;
var journalOwner;
var journalXSC_InitialOwnerExists;
var journalEmailBodyType;
var journalXSC_BodyPlain;
var journalParentLink_RecID = null;
var journalParentLink_Category = null;;
var journalXSC_InternalTicketID = null;
var journalXSC_InternalTicketType = null;
var journalParentOwner;
var journalIsUnRead;
var journalXSC_ExternalTicketID = null;
var journalXSC_ExternalTicketType = null;
var journalXSC_ParentInfo;


var CurrentUser = Get('Employee#', '$(CurrentUserRecId())');
var wsUrl = '$(SecureServerURL())/ServiceAPI/FRSHEATIntegration.asmx?wsdl';
var wsInstance = GetWebServiceFromUrl(wsUrl, "FRSHEATIntegration", null, null);
var ApplicationID = CurrentUser.SessionContext.ApplicationID();
var SessionKey = CurrentUser.SessionContext.SessionKey();

if (CurrentJournal.Fields["LastSendMailError"] != "Email with subject matching ignored list")
{
	///Set owner by Email "From"
	var CurrentJournalEmployee = Get("Employee#", "PrimaryEmail", CurrentJournalFromAddr);
	if(CurrentJournalEmployee != null){
		journalCreatedBy = CurrentJournalEmployee.Fields["LoginID"];
		journalOwner = CurrentJournalEmployee.Fields["LoginID"];
		journalXSC_InitialOwnerExists = true;
		
	} else {
		journalCreatedBy = "InternalServices";
		journalOwner = "InternalServices";
		journalXSC_InitialOwnerExists = false;
	}

	if(CurrentJournal.Fields["EmailBody"].indexOf('content="text/html') == -1){
		journalEmailBodyType = "Text"
	}
	else
	{
		journalEmailBodyType = "HTML"
	}
	///Strip HTML and put in XSC_BodyPlain
	if(journalEmailBodyType != "HTML" &amp;&amp; !new RegExp("^&lt;.*?&gt;.*").test(CurrentJournal.Fields["EmailBody"])){
		journalXSC_BodyPlain = CurrentJournal.Fields["EmailBody"];
	} else {
		var stripped = HeatUtility.HtmlDecode(CurrentJournal.Fields["EmailBody"]);
		stripped = stripped.replace(/[\r\n]{1,1}/gmi, '').replace(/&lt;style.*?&gt;.*?&lt;\/style&gt;/gmi, '').replace(/&lt;(br|tr|p).*?&gt;/gmi, '\n').replace(/&lt;(?:.|\n)*?&gt;/gm, '').replace(/[ ]{2,100}/gmi, ' ').replace(/[\n ]{2,100}/gmi, '\n');
		journalXSC_BodyPlain = stripped;
	}
		console.debug("CurrentJournalSubject: " + CurrentJournalSubject);	
		var EmailBOMapping = null;
		var result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: false});
		console.debug("Got results for XSC_TenantEmailBONameMapping# Where({XSC_3rdParty: false})");
		var mappingFound = false;
		while (result.MoveNext()) {	
			EmailBOMapping = result.Current;
			
			console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
			var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
			var matches = CurrentJournalSubject.match(matchesRegex);
			console.debug("typeof matches = " + typeof matches);
			console.debug("matches: " + matches);
			if(matches == null){
				continue;
			}
			console.debug("HEAT matches.length: " + matches.length);
			var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
			for(var i = 0; i &lt; matches.length; i++){
				var matchestrimmed = matches[i].trim();
				var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
				var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
				console.debug("ticketType: " + ticketType);
				console.debug("ticketNumber: " + ticketNumber);
			
				var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
				if(EmailBOMapping.Fields["XSC_SearchField"] != null){
					SearchField = EmailBOMapping.Fields["XSC_SearchField"];
				}
				console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
				console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
				if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
					if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
					}
					else
					{
						RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
					}
					if(RelatedTicket != null){
						console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
						journalParentLink_RecID = RelatedTicket.Fields["RecId"];
						journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
						journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
						journalXSC_InternalTicketID = ticketNumber;
						journalXSC_InternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						journalParentOwner = RelatedTicket.Fields["Owner"];
						
						mappingFound = true;
						break;
					}
				}
			}
			if(mappingFound){
				break;
			}
		}
		result.Close();
		console.debug('------------------------------------------------------');
		if(!mappingFound){
			EmailBOMapping = null;
			result = Search('XSC_TenantEmailBONameMapping#').Where({XSC_3rdParty: true});
			mappingFound = false;
			while (result.MoveNext()) {
				EmailBOMapping = result.Current;
				
				console.debug('matches pattern: [ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}');
				var matchesRegex = new RegExp('[ ]{0,1}[a-zA-Z0-9]{1,50}' + EmailBOMapping.Fields["XSC_Separator"] + '[0-9]{3,20}[ ]{0,1}', 'g');
				var matches = CurrentJournalSubject.match(matchesRegex);
				console.debug("typeof matches = " + typeof matches);
				console.debug("matches: " + matches);
				if(matches == null){
					continue;
				}
				console.debug("Non_HEAT matches.length: " + matches.length);
				var splitRegExp = new RegExp(EmailBOMapping.Fields["XSC_Separator"]);
				for(var i = 0; i &lt; matches.length; i++){
					var matchestrimmed = matches[i].trim();
					var ticketType = matchestrimmed.split(splitRegExp)[0].trim();
					var ticketNumber = matchestrimmed.split(splitRegExp)[1].trim();
					console.debug("ticketType: " + ticketType);
					console.debug("ticketNumber: " + ticketNumber);
					
					var SearchField = EmailBOMapping.Fields["TargetBOName"] + "Number";
					if(EmailBOMapping.Fields["XSC_SearchField"] != null){
						SearchField = EmailBOMapping.Fields["XSC_SearchField"];
					}
					console.debug("SourceBOName:" + EmailBOMapping.Fields["SourceBOName"]);
					console.debug("TargetBOName:" + EmailBOMapping.Fields["TargetBOName"]);
					if(ticketType == EmailBOMapping.Fields["SourceBOName"]){
						journalXSC_ExternalTicketID = ticketNumber;
						journalXSC_ExternalTicketType = EmailBOMapping.Fields["SourceBOName"];
						if(EmailBOMapping.Fields["TargetBOName"].indexOf(".") &gt; -1)
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"].replace(".","#"), SearchField, ticketNumber);
						}
						else
						{
							RelatedTicket = Get(EmailBOMapping.Fields["TargetBOName"] + "#", SearchField, ticketNumber);
						}
						if(RelatedTicket != null){
							console.debug("RelatedTicket.Fields['RecId']:" + RelatedTicket.Fields["RecId"]);
							if(CurrentJournal.Fields["ParentLink_RecID"] == null || CurrentJournal.Fields["ParentLink_RecID"].length == 0){
								journalParentLink_RecID = RelatedTicket.Fields["RecId"];
								journalParentLink_Category = EmailBOMapping.Fields["TargetBOName"];
								journalXSC_ParentInfo = RelatedTicket.Fields["RecId"]+"|"+EmailBOMapping.Fields["TargetBOName"]+"|";
								journalParentOwner = RelatedTicket.Fields["Owner"];
							}
							mappingFound = true;
							break;
						}
					}
				}
				if(mappingFound){
					break;
				}
			}
			result.Close();
		}
		// ISUnread evaluation
		if(!mappingFound){
			journalIsUnRead = 1;
		} else {
		
			if(RelatedTicket != null &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				journalIsUnRead = 0;
			} else {
				journalIsUnRead = 1;
			}
		}
		console.debug("Updating Journal");
		//TODO: Migrate to  Integration Web Service
		/*CurrentJournal.Update({
					CreatedBy:journalCreatedBy,
					Owner:journalOwner,
					XSC_InitialOwnerExists:journalXSC_InitialOwnerExists,
					EmailBodyType:journalEmailBodyType,
					XSC_BodyPlain:journalXSC_BodyPlain,
					ParentLink_RecID:journalParentLink_RecID,
					ParentLink_Category:journalParentLink_Category,
					XSC_InternalTicketID:journalXSC_InternalTicketID,
					XSC_InternalTicketType:journalXSC_InternalTicketType,
					ParentOwner:journalParentOwner,
					XSC_ExternalTicketType:journalXSC_ExternalTicketType,
					XSC_ExternalTicketID:journalXSC_ExternalTicketID,
					IsUnRead:journalIsUnRead	
				});*/
		//TODO: Migrate to  Integration Web Service
		var UpdateJournalStatus;		
		UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType', Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'ParentLink_RecID', Value: journalParentLink_RecID}, {Name: 'ParentLink_Category', Value: journalParentLink_Category}]}]);
		
		
		if (UpdateJournalStatus.status == "Success" )
		{
			console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
		}
		else if (UpdateJournalStatus.exceptionReason.indexOf("because the object is in final state") &gt; -1)
		{
			mappingFound = false;
			console.info("Related object is in final state. Updating without linkink to the parent object");
			UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'CreatedBy', Value: journalCreatedBy}, {Name: 'Owner', Value: journalOwner}, {Name: 'XSC_InitialOwnerExists', Value: journalXSC_InitialOwnerExists}, {Name: 'EmailBodyType', Value: journalEmailBodyType}, {Name: 'XSC_BodyPlain', Value: journalXSC_BodyPlain}, {Name: 'XSC_InternalTicketID', Value: journalXSC_InternalTicketID}, {Name: 'XSC_InternalTicketType', Value: journalXSC_InternalTicketType}, {Name: 'ParentOwner', Value: journalParentOwner}, {Name: 'XSC_ExternalTicketType',Value: journalXSC_ExternalTicketType}, {Name: 'XSC_ExternalTicketID', Value: journalXSC_ExternalTicketID}, {Name: 'IsUnRead', Value: journalIsUnRead}]}]);
			if (UpdateJournalStatus.status == "Success" )
			{
				console.debug("UpdateJournalStatus response: " + UpdateJournalStatus.status);
			}
			else
			{
				console.error(UpdateJournalStatus);
			}
		}
		else
		{
			console.error(UpdateJournalStatus);
			mappingFound = false;
		}

		if(mappingFound){	
			console.debug("KeywordMapping for: " + journalParentLink_Category);
			var KeywordMapping = null;
			var found_keyword = "";
			var keywordsResult = null;
			var keywordFoundInMapping = false;
			var setTicketStatusTo = "";
			var UpdateRelatedTicketStatus ="";
			if(journalParentLink_Category == "FRS_ApprovalVoteTracking" &amp;&amp; journalOwner == RelatedTicket.Fields["Owner"]){
				console.debug("FRS_ApprovalVoteTracking: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailFRSApprovalKeyword#');
				
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("FRSApprovalStatus:" + KeywordMapping.Fields["FRSApprovalStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["FRSApprovalStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["FRSApprovalStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Reason:"Status was changed by email: " + journalXSC_BodyPlain,
						VotedBy:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'FRS_ApprovalVoteTracking#', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Reason', Value: approvalReason}, {Name: 'VotedBy', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			}
			if(journalParentLink_Category == "Task.Assignment"){
				console.debug("Task.Assignment: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('TenantEmailTaskAssignmentKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("Assignment:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskAssignmentStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskAssignmentStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
						Owner:CurrentJournalEmployee.Fields["LoginID"]
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#Assignment', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}, {Name: 'Owner', Value: CurrentJournalEmployee.Fields["LoginID"]}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
			
			if(journalParentLink_Category == "Task.WorkOrder"){
				console.debug("Task.WorkOrder: found");
				console.debug("message: " + journalXSC_BodyPlain);
				found_keyword = journalXSC_BodyPlain.match(/^\s*([a-zA-Z0-9]+)/)[1].toLowerCase();
				console.debug("found_keyword: " + found_keyword);		
				keywordsResult = Search('XSC_TenantEmailTaskWorkOrderKeyword#');
				while (keywordsResult.MoveNext()) {
					KeywordMapping = keywordsResult.Current;
					console.debug("StatusKeyword:" + KeywordMapping.Fields["StatusKeyword"]);
					console.debug("WorkOrder Status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
					if(found_keyword == KeywordMapping.Fields["StatusKeyword"].toLowerCase()){
						console.debug("Set status:" + KeywordMapping.Fields["TaskWorkOrderStatus"]);
						keywordFoundInMapping = true;
						setTicketStatusTo = KeywordMapping.Fields["TaskWorkOrderStatus"];
						break;
					}
				}
				keywordsResult.Close();
				if(keywordFoundInMapping){
					/*RelatedTicket.Update({
						Status:setTicketStatusTo,
					});
					*/
					approvalReason = "Status was changed by email: " + journalXSC_BodyPlain;
					UpdateRelatedTicketStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Task#WorkOrder', ObjectId: RelatedTicket.Fields["RecId"]  , Fields:[{Name: 'Status', Value: setTicketStatusTo}]}]);
						if (UpdateRelatedTicketStatus.status == "Success" )
						{
							console.debug("UpdateRelatedTicketStatus response: " + UpdateRelatedTicketStatus.status);
						}
						else
						{
							console.error(UpdateRelatedTicketStatus);
						}
					
				}
			
			}
		}
}
	else
	{
		var UpdateJournalStatus = wsInstance.InvokeMethod("UpdateObject", [ SessionKey, ApplicationID, {ObjectType:'Journal#Email', ObjectId: "$(RecId)", Fields:[{Name: 'IsUnRead', Value: journalIsUnRead}, {Name: 'XSC_Spam', Value: 1}]}]);
	}	

console.debug("XSC Script Completed");

</Second>
        </XSLT>
      </Updates>
    </Frs_def_integration_connection>
  </Updates>
</Frs_def_integration_connections>
    </Updates>
  </Differences>
  <Views>
    <Related />
    <Unrelated />
  </Views>
</Metadata>